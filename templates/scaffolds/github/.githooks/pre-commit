#!/usr/bin/env bash
set -euo pipefail

# Pre-commit hook for validating collections and skills
# Uses @prompt-registry/collection-scripts from npm

echo "ğŸ” Running pre-commit validation..."

# Check if node_modules exists
if [ ! -d "node_modules" ]; then
  echo "âš ï¸  node_modules not found. Run 'npm install' first."
  exit 1
fi

# Run collection validation
echo "ğŸ“¦ Validating collections..."
if ! npm run validate --silent; then
  echo "âŒ Collection validation failed!"
  exit 1
fi

# Run skill validation
echo "ğŸ› ï¸  Validating skills..."
if ! npm run skill:validate --silent; then
  echo "âŒ Skill validation failed!"
  exit 1
fi

echo "âœ… All validations passed!"
exit 0
